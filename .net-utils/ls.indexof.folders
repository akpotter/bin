#!/bin/sh
# List the content of `index of` html pages (generated by servers when no index file present), folders only, sorted by name.
#   Usage: ls.indexof.folders <url...>
output_piped() { test -t 1; }

for baseurl in "$@"
do
  curl -s "$baseurl" \
    | grep '<a href="[^./]' \
    | sed -E 's/<a href="([^"]*)">.*?<\/a>/\1\t/g; s/\s{2,}/\t/g; s/\r//g' \
    | awk -F'\t+' '$3 !~ /^[0-9]+$/' \
    | (if output_piped; then align; else cat; fi)
done

